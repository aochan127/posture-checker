<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ケンダル姿勢セルフチェック v3c2（MoveNet版・画像読込強化）</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>ケンダル姿勢セルフチェック v3c2</h1>
    <p>AI（MoveNet）で5点を自動抽出。画像読み込み方法を強化しました（ボタン／直接選択／ドラッグ＆ドロップ）。</p>
  </header>

  <main>
    <section class="controls">
      <div class="file-controls">
        <label class="btn">
          画像を読み込む（ボタン）
          <input id="fileInputBtn" type="file" accept="image/*" hidden />
        </label>
        <input id="fileInputPlain" type="file" accept="image/*" />
        <button id="aiBtn" class="btn-primary" disabled>AIで自動抽出</button>
        <button id="clearBtn" class="btn-secondary">リセット</button>
      </div>

      <div class="edit-controls">
        <div class="group">
          <label>鉛直線X: <input id="plumbX" type="number" min="0" value="0" /></label>
          <button id="centerPlumbBtn" class="btn-secondary">中央に置く</button>
          <label class="checkbox"><input type="checkbox" id="togglePlumb" checked> 鉛直線を表示</label>
        </div>

        <div class="group">
          <label>ランドマーク選択：</label>
          <div class="lm-picker">
            <label><input type="radio" name="lm" value="0" checked> ①耳</label>
            <label><input type="radio" name="lm" value="1"> ②肩</label>
            <label><input type="radio" name="lm" value="2"> ③大転子</label>
            <label><input type="radio" name="lm" value="3"> ④膝</label>
            <label><input type="radio" name="lm" value="4"> ⑤外果</label>
          </div>
        </div>

        <div class="group">
          <label>検出サイド：</label>
          <select id="sideSelect">
            <option value="auto" selected>自動</option>
            <option value="left">左側</option>
            <option value="right">右側</option>
          </select>
        </div>
      </div>
    </section>

    <section class="canvas-wrap">
      <div class="canvas-col">
        <div id="dropHint" class="drop-hint">ここに画像をドラッグ＆ドロップしてもOK</div>
        <canvas id="canvas" width="720" height="960"></canvas>
      </div>
      <aside class="results">
        <h3>結果</h3>
        <div id="metrics" class="metrics"></div>
        <div id="classification" class="classification"></div>
        <details open>
          <summary>診断・ログ</summary>
          <pre id="log" class="logbox">読み込み完了。画像を選択してください。</pre>
        </details>
      </aside>
    </section>
  </main>

  <footer><p>© 2025 AORC / Posture Checker</p></footer>

  <script type="module" src="script.mjs"></script>
</body>
</html>
